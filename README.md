# Inductor

A LangGraph-based system for exploring codebases using hypothesis generation, validation, and Neo4j for knowledge storage.

## Overview

This project implements an interactive way of comprehending codebases using LangGraph. It combines:

1. **Neo4j Operations** - Basic CRUD operations for Neo4j nodes
2. **Hypothesis Management** - Creating, validating, and managing hypotheses about code functionality
3. **MCP (Model Context Protocol) Servers** - STDIO interfaces for interacting with Neo4j and hypothesis operations
4. **LangGraph Workflow** - A graph-based workflow for reverse engineering that uses LLMs to guide the process

The system allows you to:
- Generate hypotheses about code functionality
- Explore evidence to validate or refute hypotheses
- Store and manage hypotheses in a Neo4j database
- Navigate through a guided reverse engineering process

## Components

### Neo4j Operations

The Neo4j Operations module provides basic CRUD operations for Neo4j nodes, ensuring that each node has an ID and a nodeType property. This functionality is implemented in the `src/domain/neo4j_operations.py` file.

### Hypothesis Management

The Hypothesis module provides CRUD operations for Hypothesis nodes in Neo4j, with specialized functionality for handling hypotheses. It includes:

- HypothesisSubject and HypothesisObject dataclasses
- Operations for creating, reading, updating, and deleting hypotheses
- Validation of hypothesis data

This functionality is implemented in the `src/domain/hypothesis.py`, `src/domain/hypothesis_object.py`, and `src/domain/hypothesis_subject.py` files.

### MCP Servers

The project includes MCP servers that provide JSON-RPC interfaces for:

- Neo4j operations
- Hypothesis management
- Code analysis

These servers can be integrated with LangGraph using the `langchain_mcp_adapters` package. The MCP servers are implemented in the `src/agent/hypothesis_mcp_server.py` and `src/agent/simple_mcp_server.py` files.

### LangGraph Workflow

The core of the project is a LangGraph workflow that guides the reverse engineering process:

1. **Executive Agent** - Guides the overall reverse engineering process
2. **Evidence Gatherer** - Explores evidence related to hypotheses
3. **Hypothesizer** - Generates hypotheses about code functionality
4. **Inference Tree Builder** - Validates hypotheses through structured inference
5. **Free Explorer** - Allows for free exploration of the codebase
6. **System Query** - Answers questions about the MCP tools themselves

## Getting Started

### Prerequisites

1. Neo4j installed and running
2. Python 3.11+
3. LangGraph Studio (optional, for visualization)

### Installation

1. **Clone the repository:**

```bash
git clone https://github.com/asengupta/inductor
cd inductor
```

2. **Install dependencies:**

```bash
poetry install
```

For development dependencies:

```bash
poetry install --with dev
```

3. **Create a `.env` file with Neo4j connection details:**

```
NEO4J_URI=bolt://localhost:7687
NEO4J_USER=neo4j
NEO4J_PASSWORD=your_password
```

3a. Anthropic API

If you are using the **Anthropic API** directly, set the following:

```
ANTHROPIC_API_KEY=<your_anthropic_key>
ANTHROPIC_MODEL_ID=<anthropic_model_id>
```

Make sure this line is being used in ```graph_builder.py```:

```python
base_llm = anthropic_model()
```

3b. Bedrock API

If you are using the **AWS Bedrock API**, set the following:

```bash
AWS_ACCESS_KEY_ID=<aws-access-key>
AWS_SECRET_ACCESS_KEY=<aws-secret-access-key>
AWS_MODEL_ID=<bedrock-model-id>
AWS_REGION=<aws-region>
```

Make sure this line is being used in ```graph_builder.py```:

```python
base_llm = bedrock_model()
```

### Running the System

Run the LangGraph workflow using:

```bash
poetry run python src/main/inductor_main.py
```

## Usage

The system provides a conversational interface for reverse engineering code:

1. **Generate Hypotheses** - Ask the system to generate hypotheses about specific parts of the code
2. **Explore Evidence** - Request the system to gather evidence to support or refute hypotheses
3. **Validate Hypotheses** - Ask the system to validate existing hypotheses
4. **Free Exploration** - Freely explore the codebase with the help of the system

## Development

### Adding New Tools

You can extend the system by adding new tools to the MCP servers or by modifying the LangGraph workflow in `src/taskgraph/graph_builder.py`.

### Customizing the Workflow

The LangGraph workflow can be customized by modifying the `make_graph` function in `src/taskgraph/graph_builder.py`. You can add new nodes, edges, or change the flow of the conversation.

<!--
Configuration auto-generated by `langgraph template lock`. DO NOT EDIT MANUALLY.
{
  "config_schemas": {
    "agent": {
      "type": "object",
      "properties": {}
    }
  }
}
-->

## Important note on installation

If you are installing PyGraphViz using Poetry, you need to do the following. Remember to restore your ```CFLAGS``` and ```LDFLAGS``` to their previous values after.

```
export CFLAGS="-I $(brew --prefix graphviz)/include"
export LDFLAGS="-L $(brew --prefix graphviz)/lib"
poetry install
```
If you are installing through PIP for some reason, use the following:

```
python -m pip install \
    --global-option=build_ext \
    --global-option="-I$(brew --prefix graphviz)/include/" \
    --global-option="-L$(brew --prefix graphviz)/lib/" \
    pygraphviz
```

See [here](https://github.com/pygraphviz/pygraphviz/blob/main/INSTALL.txt) for more detailed options.

## License

MIT License

Copyright (c) 2025 Avishek Sen Gupta

Permission is hereby granted, free of charge, to any person obtaining a copy
of this software and associated documentation files (the "Software"), to deal
in the Software without restriction, including without limitation the rights
to use, copy, modify, merge, publish, distribute, sublicense, and/or sell
copies of the Software, and to permit persons to whom the Software is
furnished to do so, subject to the following conditions:

The above copyright notice and this permission notice shall be included in all
copies or substantial portions of the Software.

THE SOFTWARE IS PROVIDED "AS IS", WITHOUT WARRANTY OF ANY KIND, EXPRESS OR
IMPLIED, INCLUDING BUT NOT LIMITED TO THE WARRANTIES OF MERCHANTABILITY,
FITNESS FOR A PARTICULAR PURPOSE AND NONINFRINGEMENT. IN NO EVENT SHALL THE
AUTHORS OR COPYRIGHT HOLDERS BE LIABLE FOR ANY CLAIM, DAMAGES OR OTHER
LIABILITY, WHETHER IN AN ACTION OF CONTRACT, TORT OR OTHERWISE, ARISING FROM,
OUT OF OR IN CONNECTION WITH THE SOFTWARE OR THE USE OR OTHER DEALINGS IN THE
SOFTWARE.
